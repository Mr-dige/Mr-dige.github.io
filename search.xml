<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[用VBA做一个待办事项清单]]></title>
    <url>%2F2019%2F03%2F06%2F%E7%94%A8VBA%E5%81%9A%E4%B8%80%E4%B8%AA%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E6%B8%85%E5%8D%95%2F</url>
    <content type="text"><![CDATA[代码如下：12345678910111213141516171819202122232425262728293031323334353637383940414243444546Sub 刷新_Click() &apos;获取总行数 Dim max_row As Integer max_row = UsedRange.Rows.Count Dim i As Integer For i = 3 To max_row &apos;清除颜色 Range(&quot;A&quot; &amp; i &amp; &quot;:&quot; &amp; &quot;F&quot; &amp; i).Interior.ColorIndex = xlNone &apos;如果“截止日期”列非空，也即存在截止日期，则显示剩余可用天数 If Range(&quot;C&quot; &amp; i) &lt;&gt; &quot;&quot; Then Range(&quot;D&quot; &amp; i) = Range(&quot;C&quot; &amp; i) - Date End If &apos;如果“完成日期”列非空，也即已完成该事项，则将该事项优先级设为100，且不再显示截止日期与剩余可用天数 If Range(&quot;E&quot; &amp; i) &lt;&gt; &quot;&quot; Then Range(&quot;A&quot; &amp; i) = 100 Range(&quot;C&quot; &amp; i) = &quot;&quot; Range(&quot;D&quot; &amp; i) = &quot;&quot; End If Next i &apos;排序 With Worksheets(&quot;待办事项&quot;).Sort With .SortFields .Clear .Add Key:=Range(&quot;A3:A&quot; &amp; max_row), SortOn:=xlSortOnValues, Order:=xlAscending &apos;先按优先级大小排序 .Add Key:=Range(&quot;E3:E&quot; &amp; max_row), SortOn:=xlSortOnValues, Order:=xlDescending &apos;再对已完成事项按日期排序 End With .Header = xlYes .Orientation = xlSortColumns .MatchCase = False .SortMethod = xlPinYin .SetRange Rng:=Range(&quot;A2:F&quot; &amp; max_row) .Apply End With &apos;将优先级改为整数 For i = 3 To max_row If Range(&quot;A&quot; &amp; i) &lt; 100 Then Range(&quot;A&quot; &amp; i) = i - 2 End If Next i &apos;将前三项设为红色 Range(&quot;A3:F5&quot;).Interior.ColorIndex = 40End Sub 效果图如下： 使用步骤：1，填写待办事项内容。2，填写截止日期（如果存在的话）。3，根据重要性、紧急性填写优先级大小（可以填小数，刷新后会自动改为整数并顺序排序）。4，填写已完成事项的完成日期。5，点击“刷新”按钮，进行排序。]]></content>
      <categories>
        <category>一些小玩意儿</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[交易性金融资产]]></title>
    <url>%2F2019%2F03%2F03%2F%E4%BA%A4%E6%98%93%E6%80%A7%E9%87%91%E8%9E%8D%E8%B5%84%E4%BA%A7%2F</url>
    <content type="text"><![CDATA[根据业务模式、合同现金流量特征的不同，金融资产可以分为以下三类。本文主要介绍以公允价值计量且其变动计入当期损益的金融资产的账务处理，对应科目为“交易性金融资产”。 分类 条件 相关科目 以摊余成本计量的金融资产 1，业务模式：以收取合同现金流量为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 债权投资 以公允价值计量且其变动计入其他综合收益的金融资产 1，业务模式：以收取合同现金流量和出售金融资产为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 其他债权投资其他权益工具投资 以公允价值计量且其变动计入当期损益的金融资产 不属于上面两种分类的金融资产。 交易性金融资产 一、账务处理取得：12345借：交易性金融资产——成本 //公允价值 投资收益 //交易费用 应收股利 //已宣告未发放的现金股利 应收利息 //已到付息期未领取的利息 贷：银行存款 持有期间：1234567891011//宣告发放现金股利或到付息期时借：应收股利 应收利息 贷：投资收益//实际收到现金股利或利息时借：银行存款 贷：应收股利 应收利息//资产负债表日公允价值变动（以上升为例）借：交易性金融资产——公允价值变动 贷：公允价值变动损益 出售：123456借：银行存款 贷：交易性金融资产——成本 交易性金融资产——公允价值变动 投资收益 //差额借：公允价值变动损益 贷：投资收益 二、例题 例12016年1月1日，甲公司从二级市场购入丙公司债券，支付价款合计102万元（含已到付息期但尚未领取的利息2万元），另发生交易费用2万元，该债券面值100万元，剩余期限为2年，票面利率为4%，每半年末付息一次。甲公司根据其管理该债券的业务模式和该债券的合同现金流量特征，将该债券分类为以公允价值计量且其变动计入当期损益的金融资产，其他资料如下：（1）2016年1月5日，收到丙公司债券2015年下半年利息2万元。（2）2016年6月30日，丙公司债券公允价值为115万元（不含利息）。（3）2016年7月5日，收到丙公司债券2016年上半年利息。（4）2016年12月31日，丙公司债券公允价值为110万元（不含利息）。（5）2017年1月5日，收到丙公司债券2016年下半年利息。（6）2017年6月20日，通过二级市场出售丙公司债券，取得价款118万（含第一季度利息1万元）。假定不考虑其他因素，请做出购入债券至出售债券期间的相关账务处理。 【答1】账务处理如下（以下金额单位均为万元）：2016年1月1日，购入：1234借：交易性金融资产——成本 100 应收利息 2 投资收益 2 贷：银行存款 104 2016年1月5日，收到利息：12借：银行存款 2 贷：应收利息 2 2016年6月30日，确认公允价值变动，确认应收利息：1234借：交易性金融资产——公允价值变动 15 贷：公允价值变动损益 15借：应收利息 2 贷：投资收益 2 2016年7月5日，收到利息：12借：银行存款 2 贷：应收利息 2 2016年12月31日，确认公允价值变动，确认应收利息：1234借：公允价值变动损益 5 贷：交易性金融资产——公允价值变动 5借：应收利息 2 贷：投资收益 2 2017年1月5日，收到利息：12借：银行存款 2 贷：应收利息 2 2017年6月20日，出售：123456借：银行存款 118 贷：交易性金融资产——成本 100 交易性金融资产——公允价值变动 10 投资收益借：公允价值变动损益 10 贷：投资收益 10]]></content>
      <categories>
        <category>临时</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[其他权益工具投资]]></title>
    <url>%2F2019%2F03%2F03%2F%E5%85%B6%E4%BB%96%E6%9D%83%E7%9B%8A%E5%B7%A5%E5%85%B7%E6%8A%95%E8%B5%84%2F</url>
    <content type="text"><![CDATA[根据业务模式、合同现金流量特征的不同，金融资产可以分为以下三类。其中，以公允价值计量且其变动计入其他综合收益的金融资产又可以分为债务工具投资和非交易性权益工具投资。本文主要介绍后者的账务处理，对应科目为“其他权益工具投资”。 分类 条件 相关科目 以摊余成本计量的金融资产 1，业务模式：以收取合同现金流量为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 债权投资 以公允价值计量且其变动计入其他综合收益的金融资产 1，业务模式：以收取合同现金流量和出售金融资产为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 其他债权投资其他权益工具投资 以公允价值计量且其变动计入当期损益的金融资产 不属于上面两种分类的金融资产。 交易性金融资产 一、账务处理取得：123借：其他权益工具投资——成本 //公允价值 + 交易费用 应收股利 //已宣告未发放现金股利 贷：银行存款 持有期间：123456789//宣告发放现金股利时借：应收股利 贷：投资收益//实际收到现金股利时借：银行存款 贷：应收股利//资产负债表日公允价值变动（以上升为例）借：其他权益工具投资——公允价值变动 贷：其他综合收益——其他权益工具投资公允价值变动 出售：12345678借：银行存款 贷：其他权益工具投资——成本 其他权益工具投资——公允价值变动 盈余公积 //差额 * 盈余公积提取比例 利润分配——未分配利润 //差额 - 盈余公积借：其他综合收益——其他权益工具投资公允价值变动 贷：盈余公积 //其他综合收益 * 盈余公积提取比例 利润分配——未分配利润 //差额 二、例题 例12016年5月6日，甲公司支付价款1016万元（含交易费用1万元和已宣告发放的现金股利15万元），购入乙公司发行的股票200万股，占乙公司有表决权股份的0.5%。甲公司将其指定为以公允价值计量且其变动计入其他综合收益的非交易性权益工具投资。2016年5月10日，甲公司收到乙公司发放的现金股利15万元。2016年6月30日，该股票市价为每股5.2元。2016年12月31日，甲公司仍持有该股票，当日该股票市价为每股5元。2017年5月9日，乙公司宣布发放现金股利4000万元。2017年5月13日，甲公司收到乙公司发放的现金股利。2017年5月20日，甲公司由于某种特殊原因，以每股4.9元的价格将股票全部转让。假定不考虑其他因素，请做出甲公司购入股票至转让股票期间的相关账务处理。 【答1】账务处理如下（以下金额单位均为万元）：2016年5月6日，购入：123借：其他权益工具投资——成本 1001 应收股利 15 贷：银行存款 1016 2016年5月10日，收到股利：12借：银行存款 15 贷：应收股利 15 2016年6月30日，确认公允价值变动：12借：其他权益工具投资——公允价值变动 39 贷：其他综合收益——其他权益工具投资公允价值变动 39 2016年12月31日，确认公允价值变动：12借：其他综合收益——其他权益工具投资公允价值变动 40 贷：其他权益工具投资——公允价值变动 40 2017年5月9日，确认应收股利：12借：应收股利 20 贷：投资收益 20 2017年5月13日，收到现金股利：12借：银行存款 20 贷：应收股利 20 2017年5月20日，转让：12345678借：银行存款 980 //4.9 * 200 = 980 其他权益工具投资——公允价值变动 1 盈余公积——法定盈余公积 2 //20 * 10% = 2 利润分配——未分配利润 18 //20 - 2 = 18 贷：其他权益工具投资——成本 1001借：盈余公积——法定盈余公积 0.1 利润分配——未分配利润 0.9 贷：其他综合收益——其他权益工具投资公允价值变动 1]]></content>
      <categories>
        <category>临时</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[其他债权投资]]></title>
    <url>%2F2019%2F03%2F03%2F%E5%85%B6%E4%BB%96%E5%80%BA%E6%9D%83%E6%8A%95%E8%B5%84%2F</url>
    <content type="text"><![CDATA[根据业务模式、合同现金流量特征的不同，金融资产可以分为以下三类。其中，以公允价值计量且其变动计入其他综合收益的金融资产又可以分为债务工具投资和非交易性权益工具投资。本文主要介绍前者的账务处理，对应科目为“其他债权投资”。 分类 条件 相关科目 以摊余成本计量的金融资产 1，业务模式：以收取合同现金流量为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 债权投资 以公允价值计量且其变动计入其他综合收益的金融资产 1，业务模式：以收取合同现金流量和出售金融资产为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 其他债权投资其他权益工具投资 以公允价值计量且其变动计入当期损益的金融资产 不属于上面两种分类的金融资产。 交易性金融资产 一、账务处理取得：123456//以取得溢价发行的债券为例借：其他债权投资——成本 //面值 其他债权投资——利息调整 //差额 应收利息 //支付款中包含的利息，分期付息时 其他债权投资——应计利息 //支付款中包含的利息，到期一次还本付息时 贷：银行存款 持有期间：12345678910//资产负债表日计算利息借：应收利息 //分期付息债券票面利息 其他债权投资——应计利息 //到期一次还本付息债券票面利息 贷：投资收益 //实际利息 其他债权投资——利息调整 //差额借：银行存款 贷：应收利息 //分期付息债券票面利息//资产年负债表日公允价值变动（以上升为例）借：其他债权投资——公允价值变动 贷：其他综合收益——其他债权投资公允价值变动 出售：12345678借：银行存款 贷：其他债权投资——成本 其他债权投资——利息调整 其他债权投资——应计利息 其他债权投资——公允价值变动 投资收益 //差额借：其他综合收益——其他债权投资公允价值变动 贷：投资收益 二、例题 例12013年1月1日，甲公司支付价款1000万元（含交易费用）从上交所购入A公司同日发行的5年期公司债券12500份，债券票面价值总额为1250万元，票面利率4.72%，于年末支付本年度债券利息（即每年利息为59万元），本金在债券到期时一次性偿还。合同约定，该债券发行方在遇到特殊情况时可以将债券赎回，且不需要为提前赎回支付额外款项。甲公司在购买该债券时，预计发行方不会提前赎回。甲公司根据其管理该债券的业务模式和该债券的合同现金流量特征，将该债券分类为以公允价值计量且其变动计入其他综合收益的金融资产。其他资料如下：（1）2013年12月31日，A公司债券公允价值为1200万元（不含利息）。（2）2014年12月31日，A公司债券公允价值为1300万元（不含利息）。（3）2015年12月31日，A公司债券公允价值为1250万元（不含利息）。（4）2015年12月31日，A公司债券公允价值为1200万元（不含利息）。（5）2017年1月20日，通过上交所出售了A公司债券12500份，取得价款1260万元。假定不考虑所得税、减值损失等因素，请做出购入债券至出售债券期间相关账务处理。 【答1】假设实际利率为r，根据摊余成本 = 未来取得的现金流量的现值，有：解得r = 10%摊余成本及公允价值变动表： 日期 期初摊余成本（期初本金） 应收利息 实收利息与本金 期末摊余成本（期末本金，将应收未收的利息并入本金） 公允价值 公允价值变动 公允价值累计变动 2013年12月31日 1000 100 59 1041 1200 159 159 2014年12月31日 1041 104 59 1086 1300 55 214 2015年12月31日 1086 109 59 1136 1250 -100 114 2016年12月31日 1136 114 59 1191 1200 -105 9 账务处理如下（以下金额单位均为万元）：2013年1月1日，购入：123借：其他债权投资——成本 1250 贷：银行存款 1000 其他债权投资——利息调整 250 2013年12月31日，收到利息：1234567借：应收利息 59 其他债权投资——利息调整 41 贷：投资收益 100借：银行存款 59 贷：应收利息 59借：其他债权投资——公允价值变动 159 贷：其他综合收益——其他债权投资公允价值变动 159 2014年12月31日，收到利息：1234567借：应收利息 59 其他债权投资——利息调整 45 贷：投资收益 104借：银行存款 59 贷：应收利息 59借：其他债权投资——公允价值变动 55 贷：其他综合收益——其他债权投资公允价值变动 55 2015年12月31日，收到利息：1234567借：应收利息 59 其他债权投资——利息调整 50 贷：投资收益 109借：银行存款 59 贷：应收利息 59借：其他综合收益——其他债权投资公允价值变动 100 贷：其他债权投资——公允价值变动 100 2016年12月31日，收到利息：1234567借：应收利息 59 其他债权投资——利息调整 55 贷：投资收益 114借：银行存款 59 贷：应收利息 59借：其他综合收益——其他债权投资公允价值变动 105 贷：其他债权投资——公允价值变动 105 2017年1月20日，出售：1234567借：银行存款 1260 其他债权投资——利息调整 59 贷：其他债权投资——成本 1250 其他债权投资——公允价值变动 9 投资收益 60借：其他综合收益——其他债权投资公允价值变动 9 贷：投资收益 9]]></content>
      <categories>
        <category>临时</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[债权投资]]></title>
    <url>%2F2019%2F03%2F03%2F%E5%80%BA%E6%9D%83%E6%8A%95%E8%B5%84%2F</url>
    <content type="text"><![CDATA[根据业务模式、合同现金流量特征的不同，金融资产可以分为以下三类。本文主要介绍以摊余成本计量的金融资产的账务处理，对应科目为“债权投资”。 分类 条件 相关科目 以摊余成本计量的金融资产 1，业务模式：以收取合同现金流量为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 债权投资 以公允价值计量且其变动计入其他综合收益的金融资产 1，业务模式：以收取合同现金流量和出售金融资产为目标。2，合同条款规定，在特定日期产生的现金流量，仅为对本金和以未偿还本金为基础的利息的支付。 其他债权投资其他权益工具投资 以公允价值计量且其变动计入当期损益的金融资产 不属于上面两种分类的金融资产。 交易性金融资产 一、账务处理取得：123456//以取得溢价发行的债券为例借：债权投资——成本 //面值 债权投资——利息调整 //差额 应收利息 //支付款中包含的利息，分期付息时 债权投资——应计利息 //支付款中包含的利息，到期一次还本付息时 贷：银行存款 持有期间：123456借：应收利息 //分期付息债券票面利息 债权投资——应计利息 //到期一次还本付息债券票面利息 贷：投资收益 //实际利息 债权投资——利息调整 //差额借：银行存款 贷：应收利息 //分期付息债券票面利息 出售：123456借：银行存款 债权投资损失准备 贷：债权投资——成本 债权投资——利息调整 债权投资——应计利息 投资收益 //差额 二、例题 例12013年1月1日，甲公司支付价款1000万元（含交易费用）从上交所购入A公司同日发行的5年期公司债券12500份，债券票面价值总额为1250万元，票面利率4.72%，于年末支付本年度债券利息（即每年利息为59万元），本金在债券到期时一次性偿还。合同约定，该债券发行方在遇到特殊情况时可以将债券赎回，且不需要为提前赎回支付额外款项。甲公司在购买该债券时，预计发行方不会提前赎回。甲公司根据其管理该债券的业务模式和该债券的合同现金流量特征，将该债券分类为以摊余成本计量的金融资产。假定不考虑所得税、减值损失等因素。（1）请做出购入债券至债券到期期间相关账务处理。（2）假定在2015年1月1日，甲公司预计本金的一半（即625万元）将在该年年末收回，其余一半将在2017年年末收回。请做出购入债券至债券到期期间相关账务处理。（3）假定甲公司购买的A公司债券不是分期付息，而是到期一次还本付息，且利息不是以复利计算。请做出购入债券至债券到期期间相关账务处理。 【答1】假设实际利率为r，根据摊余成本 = 未来取得的现金流量的现值，有：解得r = 10%（1）摊余成本计算表： 日期 期初摊余成本（期初本金） 应收利息 实收利息与本金 期末摊余成本（期末本金，将应收未收的利息并入本金） 2013年12月31日 1000 100 59 1041 2014年12月31日 1041 104 59 1086 2015年12月31日 1086 109 59 1136 2016年12月31日 1136 114 59 1191 2017年12月31日 1191 118 59 + 1250 = 1309 0 账务处理如下（以下金额单位均为万元）：2013年1月1日，购入：123借：债权投资——成本 1250 贷：银行存款 1000 债权投资——利息调整 250 2013年12月31日，收到利息：12345借：应收利息 59 债权投资——利息调整 41 贷：投资收益 100借：银行存款 59 贷：应收利息 59 2014年12月31日，收到利息：12345借：应收利息 59 债权投资——利息调整 45 贷：投资收益 104借：银行存款 59 贷：应收利息 59 2015年12月31日，收到利息：12345借：应收利息 59 债权投资——利息调整 50 贷：投资收益 109借：银行存款 59 贷：应收利息 59 2016年12月31日，收到利息：12345借：应收利息 59 债权投资——利息调整 55 贷：投资收益 114借：银行存款 59 贷：应收利息 59 2017年12月31日，收到利息和本金：1234567借：应收利息 59 债权投资——利息调整 59 贷：投资收益 118借：银行存款 59 贷：应收利息 59借：银行存款 1250 贷：债权投资——成本 1250 （2）摊余成本计算表： 日期 期初摊余成本（期初本金） 应收利息 实收利息与本金 期末摊余成本（期末本金，将应收未收的利息并入本金） 2013年12月31日 1000 100 59 1041 2014年12月31日 1041 104 59 1086 2015年12月31日 1139 114 59 + 625 = 684 569 2016年12月31日 569 57 30 596 2017年12月31日 596 59 30 + 625 = 655 0 账务处理如下（以下金额单位均为万元）：2013年1月1日，购入：123借：债权投资——成本 1250 贷：银行存款 1000 债权投资——利息调整 250 2013年12月31日，收到利息：12345借：应收利息 59 债权投资——利息调整 41 贷：投资收益 100借：银行存款 59 贷：应收利息 59 2014年12月31日，收到利息：12345借：应收利息 59 债权投资——利息调整 45 贷：投资收益 104借：银行存款 59 贷：应收利息 59 2015年1月1日，甲公司预计年底将收回625万元本金，剩余本金仍于2017年年底收回，则2016年与2017年年底利息均为625 * 4.72% = 30万元。由于未来现金流量变动，甲公司应调整年初摊余成本，调整时采用最初确定的实际利率。摊余成本也即未来取得的现金流量的现值。因此2015年1月1日摊余成本为1139万元。2015年1月1日，摊余成本调整：12借：债权投资——利息调整 53 贷：投资收益 53 2015年12月31日，收到利息，收回一半本金：1234567借：应收利息 59 债权投资——利息调整 55 贷：投资收益 114借：银行存款 59 贷：应收利息 59借：银行存款 625 贷：债权投资——成本 625 2016年12月31日，收到利息：12345借：应收利息 30 债权投资——利息调整 27 贷：投资收益 57借：银行存款 30 贷：应收利息 30 2017年12月31日，收到利息，收回剩下本金：1234567借：应收利息 30 债权投资——利息调整 29 贷：投资收益 59借：银行存款 30 贷：应收利息 30借：银行存款 625 贷：债权投资——成本 625 （3）到期一次归还本息，且利息不以复利计算，假设实际利率为r，根据摊余成本 = 未来取得的现金流量的现值，有：解得r = 9.05%摊余成本计算表： 日期 期初摊余成本（期初本金） 应收利息 实收利息与本金 期末摊余成本（期末本金，将应收未收的利息并入本金） 2013年12月31日 1000 90.5 0 1090.5 2014年12月31日 1090.5 98.69 0 1189.19 2015年12月31日 1189.19 107.62 0 1296.81 2016年12月31日 1296.81 117.36 0 1414.17 2017年12月31日 1414.17 130.83 59 + 59 + 59 + 59 + 59 + 1250 = 1545 0 账务处理如下（以下金额单位均为万元）：2013年1月1日，购入：123借：债权投资——成本 1250 贷：银行存款 1000 债权投资——利息调整 250 2013年12月31日，确认利息收入：123借：债权投资——应计利息 59 债权投资——利息调整 31.5 贷：投资收益 90.5 2014年12月31日，确认利息收入：123借：债权投资——应计利息 59 债权投资——利息调整 39.69 贷：投资收益 98.69 2015年12月31日，确认利息收入：123借：债权投资——应计利息 59 债权投资——利息调整 48.62 贷：投资收益 107.62 2016年12月31日，确认利息收入：123借：债权投资——应计利息 59 债权投资——利息调整 58.36 贷：投资收益 117.36 2017年12月31日，确认利息收入：123456借：债权投资——应计利息 59 债权投资——利息调整 71.83 贷：投资收益 130.83 //尾数调整，采用倒减，即1545 - 1414.17 = 130.83借：银行存款 1545 贷：债权投资——成本 1250 债权投资——应计利息 295]]></content>
      <categories>
        <category>临时</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[用VBA锁定、解锁工作簿中的所有工作表]]></title>
    <url>%2F2019%2F03%2F02%2F%E7%94%A8VBA%E9%94%81%E5%AE%9A%E3%80%81%E8%A7%A3%E9%94%81%E5%B7%A5%E4%BD%9C%E7%B0%BF%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%B7%A5%E4%BD%9C%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[在一个excel工作簿中，对所有的工作表都设置了保护，且密码相同。此时可以用VBA批量撤销保护，同样的，也可以批量重新设置保护。代码如下：注意：需要将工作簿放到当前文件夹进行操作。12345678910111213141516171819202122232425262728293031323334353637383940414243Sub 解锁() Dim wbk As Workbook Dim sht As Worksheet Dim path As String Dim temp As String Dim file_name As String Dim pwd As String Dim address As String path = Application.ThisWorkbook.path &amp; &quot;\&quot; temp = InputBox(&quot;请依次输入工作簿名称及密码（中间用空格隔开）： &quot;, &quot;输入&quot;) file_name = Split(temp, &quot; &quot;)(0) pwd = Split(temp, &quot; &quot;)(1) address = path &amp; file_name Set wbk = Application.Workbooks.Open(Filename:=address) For Each sht In wbk.Worksheets sht.UnProtect password:=pwd Next wbk.Close TrueEnd SubSub 锁定() Dim wbk As Workbook Dim sht As Worksheet Dim path As String Dim temp As String Dim file_name As String Dim pwd As String Dim address As String path = Application.ThisWorkbook.path &amp; &quot;\&quot; temp = InputBox(&quot;请依次输入工作簿名称及密码（中间用空格隔开）： &quot;, &quot;输入&quot;) file_name = Split(temp, &quot; &quot;)(0) pwd = Split(temp, &quot; &quot;)(1) address = path &amp; file_name Set wbk = Application.Workbooks.Open(Filename:=address) For Each sht In wbk.Worksheets sht.Protect password:=pwd Next wbk.Close TrueEnd Sub]]></content>
      <categories>
        <category>一些小玩意儿</category>
      </categories>
  </entry>
</search>
