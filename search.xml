<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[用VBA锁定、解锁工作簿中的所有工作表]]></title>
    <url>%2F2019%2F04%2F09%2F%E7%94%A8VBA%E9%94%81%E5%AE%9A%E3%80%81%E8%A7%A3%E9%94%81%E5%B7%A5%E4%BD%9C%E7%B0%BF%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%B7%A5%E4%BD%9C%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[在一个excel工作簿中，对所有的工作表都设置了保护，且密码相同。此时可以用VBA批量撤销保护，同样的，也可以批量重新设置保护。代码如下：注意：需要将工作簿放到当前文件夹进行操作。12345678910111213141516171819202122232425262728293031323334353637383940414243Sub 解锁_Click() Dim wbk As Workbook Dim sht As Worksheet Dim path As String Dim temp As String Dim file_name As String Dim pwd As String Dim address As String path = Application.ThisWorkbook.path &amp; &quot;\&quot; temp = InputBox(&quot;请依次输入工作簿名称及密码（中间用空格隔开）： &quot;, &quot;输入&quot;) file_name = Split(temp, &quot; &quot;)(0) pwd = Split(temp, &quot; &quot;)(1) address = path &amp; file_name Set wbk = Application.Workbooks.Open(Filename:=address) For Each sht In wbk.Worksheets sht.Unprotect Password:=pwd Next wbk.Close TrueEnd SubSub 锁定_Click() Dim wbk As Workbook Dim sht As Worksheet Dim path As String Dim temp As String Dim file_name As String Dim pwd As String Dim address As String path = Application.ThisWorkbook.path &amp; &quot;\&quot; temp = InputBox(&quot;请依次输入工作簿名称及密码（中间用空格隔开）： &quot;, &quot;输入&quot;) file_name = Split(temp, &quot; &quot;)(0) pwd = Split(temp, &quot; &quot;)(1) address = path &amp; file_name Set wbk = Application.Workbooks.Open(Filename:=address) For Each sht In wbk.Worksheets sht.Protect Password:=pwd Next wbk.Close TrueEnd Sub 附件下载：解锁and锁定.xlsm]]></content>
      <categories>
        <category>小玩意儿</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[用VBA做一个待办事项清单]]></title>
    <url>%2F2019%2F04%2F09%2F%E7%94%A8VBA%E5%81%9A%E4%B8%80%E4%B8%AA%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9%E6%B8%85%E5%8D%95%2F</url>
    <content type="text"><![CDATA[代码如下：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051Sub 刷新_Click() &apos;获取总行数 Dim max_row As Integer max_row = UsedRange.Rows.Count Dim i As Integer For i = 3 To max_row &apos;清除颜色 Range(&quot;A&quot; &amp; i &amp; &quot;:&quot; &amp; &quot;F&quot; &amp; i).Interior.ColorIndex = xlNone &apos;如果“截止日期”列非空，也即存在截止日期，则显示剩余可用天数 If Range(&quot;C&quot; &amp; i) &lt;&gt; &quot;&quot; Then Range(&quot;D&quot; &amp; i) = Range(&quot;C&quot; &amp; i) - Date End If &apos;如果“完成日期”列非空，也即已完成该事项，则将该事项优先级设为100，且不再显示截止日期与剩余可用天数 If Range(&quot;E&quot; &amp; i) &lt;&gt; &quot;&quot; Then Range(&quot;A&quot; &amp; i) = 100 Range(&quot;C&quot; &amp; i) = &quot;&quot; Range(&quot;D&quot; &amp; i) = &quot;&quot; End If Next i &apos;排序 With Worksheets(&quot;待办事项清单&quot;).Sort With .SortFields .Clear .Add Key:=Range(&quot;A3:A&quot; &amp; max_row), SortOn:=xlSortOnValues, Order:=xlAscending &apos;先按优先级大小排序 .Add Key:=Range(&quot;E3:E&quot; &amp; max_row), SortOn:=xlSortOnValues, Order:=xlDescending &apos;再对已完成事项按日期排序 End With .Header = xlYes .Orientation = xlSortColumns .MatchCase = False .SortMethod = xlPinYin .SetRange Rng:=Range(&quot;A2:F&quot; &amp; max_row) .Apply End With &apos;将优先级改为整数，将已完成事项字体设为灰色 For i = 3 To max_row If Range(&quot;A&quot; &amp; i) &lt; 100 Then Range(&quot;A&quot; &amp; i) = i - 2 Else Range(&quot;A&quot; &amp; i &amp; &quot;:&quot; &amp; &quot;F&quot; &amp; i).Font.ColorIndex = 16 End If Next i &apos;将前三项底色设为红色 Range(&quot;A3:F5&quot;).Interior.ColorIndex = 40 &apos;将光标定位到第一个事项 Range(&quot;B3&quot;).SelectEnd Sub 效果图如下： 使用步骤：1，填写待办事项内容。2，填写截止日期（如果存在的话）。3，根据重要性、紧急性填写优先级大小（可以填小数，刷新后会自动改为整数并顺序排序）。4，填写已完成事项的完成日期。5，点击“刷新”按钮，进行排序。 附件下载：待办事项清单.xlsm]]></content>
      <categories>
        <category>小玩意儿</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[作息表]]></title>
    <url>%2F2019%2F04%2F09%2F%E4%BD%9C%E6%81%AF%E8%A1%A8%2F</url>
    <content type="text"><![CDATA[自律的生活从良好的作息开始！ 作息表： 编号 内容 开始时间 结束时间 1 在无不可抗因素干扰的情况下，早起时间：6:00 - 7:00，晚睡时间：23:00 - 24:00，午休时间：30 - 60 min 2019-4-9 - 作息执行情况： 日期 适用作息表编号 执行情况 备注 2019-4-9 1 √ -]]></content>
      <categories>
        <category>作息表</category>
      </categories>
  </entry>
</search>
